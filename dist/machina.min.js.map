{"version":3,"sources":["webpack://machina/webpack/universalModuleDefinition","webpack://machina/./src/events.js","webpack://machina/./src/emitter.js","webpack://machina/./src/utils.js","webpack://machina/./src/BehavioralFsm.js","webpack://machina/./src/Fsm.js","webpack://machina/./src/index.js","webpack://machina/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack://machina/webpack/bootstrap","webpack://machina/webpack/runtime/compat get default export","webpack://machina/webpack/runtime/define property getters","webpack://machina/webpack/runtime/harmony module decorator","webpack://machina/webpack/runtime/hasOwnProperty shorthand","webpack://machina/webpack/startup"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__760__","NEXT_TRANSITION","HANDLING","HANDLED","NO_HANDLER","TRANSITION","TRANSITIONED","INVALID_STATE","DEFERRED","NEW_FSM","getInstance","emit","args","eventName","eventListeners","_","callback","useSafeEmit","apply","exception","console","log","stack","bind","slice","on","self","push","off","_instance","machinaCount","makeFsmNamespace","getDefaultBehavioralOptions","initialState","states","namespace","hierarchy","pendingDelegations","_machKeys","utils","createUUID","s","hexDigits","i","substr","Math","floor","random","join","extend","protoProps","staticProps","fsm","parent","machObj","Ctor","hasOwnProperty","constructor","instanceStates","blendedState","prototype","accum","val","key","indexOf","__super__","getDefaultOptions","getDefaultClientMeta","inputQueue","targetReplayState","state","undefined","priorState","priorAction","currentAction","currentActionArgs","inExitHandler","getChildFsmInstance","config","childFsmDefinition","instance","listenToChild","child","data","ticket","events","delegated","bubbling","inputType","handle","topLevelEmitter","emitterInstance","BehavioralFsm","options","initialize","initClient","client","Error","transition","configForState","newState","newStateObj","childListener","_child","ensureClientMeta","buildEventPayload","getHandlerArgs","isCatchAll","_args","input","splice","concat","getSystemHandlerArgs","inputDef","clientMeta","handlerName","handler","result","action","currentState","stateObj","eventPayload","delegatedTo","curState","curStateObj","_onExit","call","fromState","toState","_onEnter","processQueue","attemptedState","deferUntilTransition","stateName","stateList","queued","type","untilState","queuedArgs","deferAndTransition","toProcess","item","clearQueue","name","evnt","length","compositeState","Fsm","arguments","_stamped","ensureClientArg","unshift","methodWithClientInjected","newFsm","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","id","loaded","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","hmd","create","children","set","obj","prop","__webpack_exports__"],"mappings":"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","file":"machina.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"machina\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"machina\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__760__) {\nreturn ","module.exports = {\n\tNEXT_TRANSITION: \"transition\",\n\tHANDLING: \"handling\",\n\tHANDLED: \"handled\",\n\tNO_HANDLER: \"nohandler\",\n\tTRANSITION: \"transition\",\n\tTRANSITIONED: \"transitioned\",\n\tINVALID_STATE: \"invalidstate\",\n\tDEFERRED: \"deferred\",\n\tNEW_FSM: \"newfsm\",\n};\n","import _ from \"lodash\";\n\nexport function getInstance() {\n\treturn {\n\t\temit( ...args ) {\n\t\t\tconst [ eventName, ] = args;\n\t\t\tif ( this.eventListeners[ \"*\" ] ) {\n\t\t\t\t_.each( this.eventListeners[ \"*\" ], function( callback ) {\n\t\t\t\t\tif ( !this.useSafeEmit ) {\n\t\t\t\t\t\tcallback.apply( this, args );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcallback.apply( this, args );\n\t\t\t\t\t\t} catch ( exception ) {\n\t\t\t\t\t\t\t/* istanbul ignore else  */\n\t\t\t\t\t\t\tif ( console && typeof console.log !== \"undefined\" ) { // eslint-disable-line no-console\n\t\t\t\t\t\t\t\tconsole.log( exception.stack ); // eslint-disable-line no-console\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}.bind( this ) );\n\t\t\t}\n\t\t\tif ( this.eventListeners[ eventName ] ) {\n\t\t\t\t_.each( this.eventListeners[ eventName ], function( callback ) {\n\t\t\t\t\tif ( !this.useSafeEmit ) {\n\t\t\t\t\t\tcallback.apply( this, args.slice( 1 ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcallback.apply( this, args.slice( 1 ) );\n\t\t\t\t\t\t} catch ( exception ) {\n\t\t\t\t\t\t\t/* istanbul ignore else  */\n\t\t\t\t\t\t\tif ( console && typeof console.log !== \"undefined\" ) { // eslint-disable-line no-console\n\t\t\t\t\t\t\t\tconsole.log( exception.stack ); // eslint-disable-line no-console\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}.bind( this ) );\n\t\t\t}\n\t\t},\n\n\t\ton( eventName, callback ) {\n\t\t\tconst self = this;\n\t\t\tself.eventListeners = self.eventListeners || { \"*\": [], };\n\t\t\tif ( !self.eventListeners[ eventName ] ) {\n\t\t\t\tself.eventListeners[ eventName ] = [];\n\t\t\t}\n\t\t\tself.eventListeners[ eventName ].push( callback );\n\t\t\treturn {\n\t\t\t\teventName,\n\t\t\t\tcallback,\n\t\t\t\toff() {\n\t\t\t\t\tself.off( eventName, callback );\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\n\t\toff( eventName, callback ) {\n\t\t\tthis.eventListeners = this.eventListeners || { \"*\": [], };\n\t\t\tif ( !eventName ) {\n\t\t\t\tthis.eventListeners = {};\n\t\t\t} else if ( callback ) {\n\t\t\t\tthis.eventListeners[ eventName ] = _.without( this.eventListeners[ eventName ], callback );\n\t\t\t} else {\n\t\t\t\tthis.eventListeners[ eventName ] = [];\n\t\t\t}\n\t\t},\n\t};\n}\n\nconst _instance = getInstance();\n\nexport { _instance as instance };\n","import events from \"./events.js\";\nimport _ from \"lodash\";\n\nconst makeFsmNamespace = ( function() {\n\tlet machinaCount = 0;\n\treturn function() {\n\t\treturn `fsm.${ machinaCount++ }`;\n\t};\n}() );\n\nfunction getDefaultBehavioralOptions() {\n\treturn {\n\t\tinitialState: \"uninitialized\",\n\t\teventListeners: {\n\t\t\t\"*\": [],\n\t\t},\n\t\tstates: {},\n\t\tnamespace: makeFsmNamespace(),\n\t\tuseSafeEmit: false,\n\t\thierarchy: {},\n\t\tpendingDelegations: {},\n\t};\n}\n\nfunction getDefaultClientMeta() {\n\treturn {\n\t\tinputQueue: [],\n\t\ttargetReplayState: \"\",\n\t\tstate: undefined,\n\t\tpriorState: undefined,\n\t\tpriorAction: \"\",\n\t\tcurrentAction: \"\",\n\t\tcurrentActionArgs: undefined,\n\t\tinExitHandler: false,\n\t};\n}\n\n/*\n\thandle ->\n\t\tchild = stateObj._child && stateObj._child.instance;\n\n\ttransition ->\n\t\tnewStateObj._child = getChildFsmInstance( newStateObj._child );\n\t\tchild = newStateObj._child && newStateObj._child.instance;\n*/\nfunction getChildFsmInstance( config ) {\n\tif ( !config ) {\n\t\treturn;\n\t}\n\tlet childFsmDefinition = {};\n\tif ( typeof config === \"object\" ) {\n\t\t// is this a config object with a factory?\n\t\tif ( config.factory ) {\n\t\t\tchildFsmDefinition = config;\n\t\t\tchildFsmDefinition.instance = childFsmDefinition.factory();\n\t\t} else {\n\t\t\t// assuming this is a machina instance\n\t\t\tchildFsmDefinition.factory = function() {\n\t\t\t\treturn config;\n\t\t\t};\n\t\t}\n\t} else if ( typeof config === \"function\" ) {\n\t\tchildFsmDefinition.factory = config;\n\t}\n\tchildFsmDefinition.instance = childFsmDefinition.factory();\n\treturn childFsmDefinition;\n}\n\nfunction listenToChild( fsm, child ) {\n\t// Need to investigate potential for discarded event\n\t// listener memory leak in long-running, deeply-nested hierarchies.\n\treturn child.on( \"*\", function( eventName, data ) {\n\t\tlet ticket;\n\t\tswitch ( eventName ) {\n\t\tcase events.NO_HANDLER:\n\t\t\tif ( !data.ticket && !data.delegated && data.namespace !== fsm.namespace ) {\n\t\t\t\t// Ok - we're dealing w/ a child handling input that should bubble up\n\t\t\t\tdata.args[ 1 ].bubbling = true;\n\t\t\t}\n\t\t\t// we do NOT bubble _reset inputs up to the parent\n\t\t\tif ( data.inputType !== \"_reset\" ) {\n\t\t\t\tfsm.handle.apply( fsm, data.args ); // eslint-disable-line prefer-spread\n\t\t\t}\n\t\t\tbreak;\n\t\tcase events.HANDLING :\n\t\t\tticket = data.ticket;\n\t\t\tif ( ticket && fsm.pendingDelegations[ ticket ] ) {\n\t\t\t\tdelete fsm.pendingDelegations[ ticket ];\n\t\t\t}\n\t\t\tfsm.emit( eventName, data ); // possibly transform payload?\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfsm.emit( eventName, data ); // possibly transform payload?\n\t\t\tbreak;\n\t\t}\n\t} );\n}\n\n// _machKeys are members we want to track across the prototype chain of an extended FSM constructor\n// Since we want to eventually merge the aggregate of those values onto the instance so that FSMs\n// that share the same extended prototype won't share state *on* those prototypes.\nconst _machKeys = [ \"states\", \"initialState\", ];\nconst extend = function( protoProps, staticProps ) {\n\tconst parent = this; // eslint-disable-line no-invalid-this, consistent-this\n\tlet fsm; // placeholder for instance constructor\n\tconst machObj = {}; // object used to hold initialState & states from prototype for instance-level merging\n\tconst Ctor = function() {}; // placeholder ctor function used to insert level in prototype chain\n\n\t// The constructor function for the new subclass is either defined by you\n\t// (the \"constructor\" property in your `extend` definition), or defaulted\n\t// by us to simply call the parent's constructor.\n\tif ( protoProps && protoProps.hasOwnProperty( \"constructor\" ) ) {\n\t\tfsm = protoProps.constructor;\n\t} else {\n\t\t// The default machina constructor (when using inheritance) creates a\n\t\t// deep copy of the states/initialState values from the prototype and\n\t\t// extends them over the instance so that they'll be instance-level.\n\t\t// If an options arg (args[0]) is passed in, a states or intialState\n\t\t// value will be preferred over any data pulled up from the prototype.\n\t\tfsm = function( ...args ) {\n\t\t\targs[ 0 ] = args[ 0 ] || {};\n\t\t\tconst instanceStates = args[ 0 ].states || {};\n\t\t\tconst blendedState = _.merge( _.cloneDeep( machObj ), { states: instanceStates, } );\n\t\t\tblendedState.initialState = args[ 0 ].initialState || this.initialState; // eslint-disable-line no-invalid-this\n\t\t\t_.extend( args[ 0 ], blendedState );\n\t\t\tparent.apply( this, args ); // eslint-disable-line no-invalid-this\n\t\t};\n\t}\n\n\t// Inherit class (static) properties from parent.\n\t_.merge( fsm, parent );\n\n\t// Set the prototype chain to inherit from `parent`, without calling\n\t// `parent`'s constructor function.\n\tCtor.prototype = parent.prototype;\n\tfsm.prototype = new Ctor();\n\n\t// Add prototype properties (instance properties) to the subclass,\n\t// if supplied.\n\tif ( protoProps ) {\n\t\t_.extend( fsm.prototype, protoProps );\n\t\t_.merge( machObj, _.transform( protoProps, function( accum, val, key ) {\n\t\t\tif ( _machKeys.indexOf( key ) !== -1 ) {\n\t\t\t\taccum[ key ] = val;\n\t\t\t}\n\t\t} ) );\n\t}\n\n\t// Add static properties to the constructor function, if supplied.\n\tif ( staticProps ) {\n\t\t_.merge( fsm, staticProps );\n\t}\n\n\t// Correctly set child's `prototype.constructor`.\n\tfsm.prototype.constructor = fsm;\n\n\t// Set a convenience property in case the parent's prototype is needed later.\n\tfsm.__super__ = parent.prototype;\n\treturn fsm;\n};\n\n/* eslint-disable no-magic-numbers */\nfunction createUUID() {\n\tconst s = [];\n\tconst hexDigits = \"0123456789abcdef\";\n\tfor ( let i = 0; i < 36; i++ ) {\n\t\ts[ i ] = hexDigits.substr( Math.floor( Math.random() * 0x10 ), 1 );\n\t}\n\ts[ 14 ] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n\ts[ 19 ] = hexDigits.substr( ( s[ 19 ] & 0x3 ) | 0x8, 1 ); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n\ts[ 8 ] = s[ 13 ] = s[ 18 ] = s[ 23 ] = \"-\";\n\treturn s.join( \"\" );\n}\n/* eslint-enable no-magic-numbers */\n\nconst utils = {\n\tcreateUUID,\n\textend,\n\tgetDefaultBehavioralOptions,\n\tgetDefaultOptions: getDefaultBehavioralOptions,\n\tgetDefaultClientMeta,\n\tgetChildFsmInstance,\n\tlistenToChild,\n\tmakeFsmNamespace,\n};\n\nexport { utils };\n","import _ from \"lodash\";\nimport { utils } from \"./utils\";\nimport { instance as emitterInstance, getInstance } from \"./emitter\";\nimport events from \"./events\";\nconst topLevelEmitter = emitterInstance;\n\nconst MACHINA_PROP = \"__machina__\";\n\nfunction BehavioralFsm( ...args ) {\n\tconst [ options, ] = args;\n\t_.extend( this, options );\n\t_.defaults( this, utils.getDefaultBehavioralOptions() );\n\tthis.initialize( ...args );\n\ttopLevelEmitter.emit( events.NEW_FSM, this );\n}\n\n_.extend( BehavioralFsm.prototype, {\n\tinitialize() {},\n\n\tinitClient( client ) {\n\t\tconst initialState = this.initialState;\n\t\tif ( !initialState ) {\n\t\t\tthrow new Error( \"You must specify an initial state for this FSM\" );\n\t\t}\n\t\tif ( !this.states[ initialState ] ) {\n\t\t\tthrow new Error( \"The initial state specified does not exist in the states object.\" );\n\t\t}\n\t\tthis.transition( client, initialState );\n\t},\n\n\tconfigForState: function configForState( newState ) {\n\t\tconst newStateObj = this.states[ newState ];\n\t\tlet child;\n\t\t_.each( this.hierarchy, function( childListener /* key */ ) {\n\t\t\tif ( childListener && typeof childListener.off === \"function\" ) {\n\t\t\t\tchildListener.off();\n\t\t\t}\n\t\t} );\n\n\t\tif ( newStateObj._child ) {\n\t\t\tnewStateObj._child = utils.getChildFsmInstance( newStateObj._child );\n\t\t\tchild = newStateObj._child && newStateObj._child.instance;\n\t\t\tthis.hierarchy[ child.namespace ] = utils.listenToChild( this, child );\n\t\t}\n\n\t\treturn child;\n\t},\n\n\tensureClientMeta: function ensureClientMeta( client ) {\n\t\tif ( typeof client !== \"object\" ) {\n\t\t\tthrow new Error( \"An FSM client must be an object.\" );\n\t\t}\n\t\tclient[ MACHINA_PROP ] = client[ MACHINA_PROP ] || {};\n\t\tif ( !client[ MACHINA_PROP ][ this.namespace ] ) {\n\t\t\tclient[ MACHINA_PROP ][ this.namespace ] = _.cloneDeep( utils.getDefaultClientMeta() );\n\t\t\tthis.initClient( client );\n\t\t}\n\t\treturn client[ MACHINA_PROP ][ this.namespace ];\n\t},\n\n\tbuildEventPayload( client, data ) {\n\t\tif ( _.isPlainObject( data ) ) {\n\t\t\treturn _.extend( data, { client, namespace: this.namespace, } );\n\t\t}\n\t\treturn { client, data: data || null, namespace: this.namespace, };\n\t},\n\n\tgetHandlerArgs( args, isCatchAll ) {\n\t\t// index 0 is the client, index 1 is inputType\n\t\t// if we're in a catch-all handler, input type needs to be included in the args\n\t\t// inputType might be an object, so we need to just get the inputType string if so\n\t\tconst _args = args.slice( 0 );\n\t\tconst input = _args[ 1 ];\n\t\tif ( typeof input === \"object\" ) {\n\t\t\t_args.splice( 1, 1, input.inputType );\n\t\t}\n\t\treturn isCatchAll ?\n\t\t\t_args :\n\t\t\t[ _args[ 0 ], ].concat( _args.slice( 2 ) );\n\t},\n\n\tgetSystemHandlerArgs( args, client ) {\n\t\treturn [ client, ].concat( args );\n\t},\n\n\t// eslint-disable-next-line max-statements\n\thandle( ...args ) {\n\t\tconst [ client, input, ] = args;\n\t\tlet inputDef = input;\n\t\tif ( typeof input === \"undefined\" ) {\n\t\t\tthrow new Error( \"The input argument passed to the FSM's handle method is undefined. Did you forget to pass the input name?\" );\n\t\t}\n\t\tif ( typeof input === \"string\" ) {\n\t\t\tinputDef = { inputType: input, delegated: false, ticket: undefined, };\n\t\t}\n\t\tconst clientMeta = this.ensureClientMeta( client );\n\t\tif ( typeof input !== \"object\" ) {\n\t\t\targs.splice( 1, 1, inputDef );\n\t\t}\n\t\tclientMeta.currentActionArgs = args.slice( 1 );\n\t\tconst currentState = clientMeta.state;\n\t\tconst stateObj = this.states[ currentState ];\n\t\tlet handlerName,\n\t\t\thandler,\n\t\t\tchild,\n\t\t\tresult,\n\t\t\taction;\n\t\tlet isCatchAll = false;\n\t\tif ( !clientMeta.inExitHandler ) {\n\t\t\tchild = this.configForState( currentState );\n\t\t\tif ( child && !this.pendingDelegations[ inputDef.ticket ] && !inputDef.bubbling ) {\n\t\t\t\tinputDef.ticket = ( inputDef.ticket || utils.createUUID() );\n\t\t\t\tinputDef.delegated = true;\n\t\t\t\tthis.pendingDelegations[ inputDef.ticket ] = { delegatedTo: child.namespace, };\n\t\t\t\t// WARNING - returning a value from `handle` on child FSMs is not really supported.\n\t\t\t\t// If you need to return values from child FSM input handlers, use events instead.\n\t\t\t\tresult = child.handle( ...args );\n\t\t\t} else {\n\t\t\t\tif ( inputDef.ticket && this.pendingDelegations[ inputDef.ticket ] ) {\n\t\t\t\t\tdelete this.pendingDelegations[ inputDef.ticket ];\n\t\t\t\t}\n\t\t\t\thandlerName = stateObj[ inputDef.inputType ] ? inputDef.inputType : \"*\";\n\t\t\t\tisCatchAll = ( handlerName === \"*\" );\n\t\t\t\thandler = ( stateObj[ handlerName ] || this[ handlerName ] ) || this[ \"*\" ];\n\t\t\t\taction = `${ clientMeta.state }.${ handlerName }`;\n\t\t\t\tclientMeta.currentAction = action;\n\t\t\t\tconst eventPayload = this.buildEventPayload(\n\t\t\t\t\tclient,\n\t\t\t\t\t{ inputType: inputDef.inputType, delegated: inputDef.delegated, ticket: inputDef.ticket, }\n\t\t\t\t);\n\t\t\t\tif ( !handler ) {\n\t\t\t\t\tthis.emit( events.NO_HANDLER, _.extend( { args, }, eventPayload ) );\n\t\t\t\t} else {\n\t\t\t\t\tthis.emit( events.HANDLING, eventPayload );\n\t\t\t\t\tif ( typeof handler === \"function\" ) {\n\t\t\t\t\t\tresult = handler.apply( this, this.getHandlerArgs( args, isCatchAll ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = handler;\n\t\t\t\t\t\tthis.transition( client, handler );\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit( events.HANDLED, eventPayload );\n\t\t\t\t}\n\t\t\t\tclientMeta.priorAction = clientMeta.currentAction;\n\t\t\t\tclientMeta.currentAction = \"\";\n\t\t\t\tclientMeta.currentActionArgs = undefined;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t// eslint-disable-next-line max-statements\n\ttransition( client, newState, ...args ) {\n\t\tconst clientMeta = this.ensureClientMeta( client );\n\t\tconst curState = clientMeta.state;\n\t\tconst curStateObj = this.states[ curState ];\n\t\tconst newStateObj = this.states[ newState ];\n\t\tlet child;\n\t\tif ( !clientMeta.inExitHandler && newState !== curState ) {\n\t\t\tif ( newStateObj ) {\n\t\t\t\tchild = this.configForState( newState );\n\t\t\t\tif ( curStateObj && curStateObj._onExit ) {\n\t\t\t\t\tclientMeta.inExitHandler = true;\n\t\t\t\t\tcurStateObj._onExit.call( this, client );\n\t\t\t\t\tclientMeta.inExitHandler = false;\n\t\t\t\t}\n\t\t\t\tclientMeta.targetReplayState = newState;\n\t\t\t\tclientMeta.priorState = curState;\n\t\t\t\tclientMeta.state = newState;\n\t\t\t\tconst eventPayload = this.buildEventPayload( client, {\n\t\t\t\t\tfromState: clientMeta.priorState,\n\t\t\t\t\taction: clientMeta.currentAction,\n\t\t\t\t\ttoState: newState,\n\t\t\t\t} );\n\t\t\t\tthis.emit( events.TRANSITION, eventPayload );\n\t\t\t\tif ( newStateObj._onEnter ) {\n\t\t\t\t\tnewStateObj._onEnter.apply( this, this.getSystemHandlerArgs( args, client ) );\n\t\t\t\t}\n\t\t\t\tthis.emit( events.TRANSITIONED, eventPayload );\n\t\t\t\tif ( child ) {\n\t\t\t\t\tchild.handle( client, \"_reset\" );\n\t\t\t\t}\n\n\t\t\t\tif ( clientMeta.targetReplayState === newState ) {\n\t\t\t\t\tthis.processQueue( client, events.NEXT_TRANSITION );\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit( events.INVALID_STATE, this.buildEventPayload( client, {\n\t\t\t\tstate: clientMeta.state,\n\t\t\t\tattemptedState: newState,\n\t\t\t} ) );\n\t\t}\n\t},\n\n\tdeferUntilTransition( client, stateName ) {\n\t\tconst clientMeta = this.ensureClientMeta( client );\n\t\tconst stateList = _.isArray( stateName ) ? stateName : ( stateName ? [ stateName, ] : undefined ); // eslint-disable-line no-nested-ternary\n\t\tif ( clientMeta.currentActionArgs ) {\n\t\t\tconst queued = {\n\t\t\t\ttype: events.NEXT_TRANSITION,\n\t\t\t\tuntilState: stateList,\n\t\t\t\targs: clientMeta.currentActionArgs,\n\t\t\t};\n\t\t\tclientMeta.inputQueue.push( queued );\n\t\t\tconst eventPayload = this.buildEventPayload( client, {\n\t\t\t\tstate: clientMeta.state,\n\t\t\t\tqueuedArgs: queued,\n\t\t\t} );\n\t\t\tthis.emit( events.DEFERRED, eventPayload );\n\t\t}\n\t},\n\n\tdeferAndTransition( client, stateName ) {\n\t\tthis.deferUntilTransition( client, stateName );\n\t\tthis.transition( client, stateName );\n\t},\n\n\tprocessQueue( client ) {\n\t\tconst clientMeta = this.ensureClientMeta( client );\n\t\tconst filterFn = function( item ) {\n\t\t\treturn ( ( !item.untilState ) || ( _.includes( item.untilState, clientMeta.state ) ) );\n\t\t};\n\t\tconst toProcess = _.filter( clientMeta.inputQueue, filterFn );\n\t\tclientMeta.inputQueue = _.difference( clientMeta.inputQueue, toProcess );\n\t\t_.each( toProcess, function( item ) {\n\t\t\tthis.handle( ...[ client, ].concat( item.args ) );\n\t\t}.bind( this ) );\n\t},\n\n\tclearQueue( client, name ) {\n\t\tconst clientMeta = this.ensureClientMeta( client );\n\t\tif ( !name ) {\n\t\t\tclientMeta.inputQueue = [];\n\t\t} else {\n\t\t\t// first pass we remove the target state from any `untilState` array\n\t\t\t_.each( clientMeta.inputQueue, function( item ) {\n\t\t\t\titem.untilState = _.without( item.untilState, name );\n\t\t\t} );\n\t\t\t// second pass we clear out deferred events with empty untilState arrays\n\t\t\tconst filter = function( evnt ) {\n\t\t\t\treturn evnt.untilState.length !== 0;\n\t\t\t};\n\t\t\tclientMeta.inputQueue = _.filter( clientMeta.inputQueue, filter );\n\t\t}\n\t},\n\n\tcompositeState( client ) {\n\t\tconst clientMeta = this.ensureClientMeta( client );\n\t\tlet state = clientMeta.state;\n\t\tconst child = this.states[ state ]._child && this.states[ state ]._child.instance;\n\t\tif ( child ) {\n\t\t\tstate += `.${ child.compositeState( client ) }`;\n\t\t}\n\t\treturn state;\n\t},\n}, getInstance() );\n\nBehavioralFsm.extend = utils.extend;\n\nexport { BehavioralFsm };\n","import { BehavioralFsm } from \"./BehavioralFsm\";\nimport { utils } from \"./utils\";\nimport _ from \"lodash\";\n\nlet Fsm = {\n\tconstructor() {\n\t\tBehavioralFsm.apply( this, arguments ); // eslint-disable-line prefer-rest-params\n\t\tthis.ensureClientMeta();\n\t},\n\tinitClient: function initClient() {\n\t\tconst initialState = this.initialState;\n\t\tif ( !initialState ) {\n\t\t\tthrow new Error( \"You must specify an initial state for this FSM\" );\n\t\t}\n\t\tif ( !this.states[ initialState ] ) {\n\t\t\tthrow new Error( \"The initial state specified does not exist in the states object.\" );\n\t\t}\n\t\tthis.transition( initialState );\n\t},\n\tensureClientMeta: function ensureClientMeta() {\n\t\tif ( !this._stamped ) {\n\t\t\tthis._stamped = true;\n\t\t\t_.defaults( this, _.cloneDeep( utils.getDefaultClientMeta() ) );\n\t\t\tthis.initClient();\n\t\t}\n\t\treturn this;\n\t},\n\n\tensureClientArg( args ) {\n\t\tconst _args = args;\n\t\t// we need to test the args and verify that if a client arg has\n\t\t// been passed, it must be this FSM instance (this isn't a behavioral FSM)\n\t\tif ( typeof _args[ 0 ] === \"object\" && !( \"inputType\" in _args[ 0 ] ) && _args[ 0 ] !== this ) {\n\t\t\t_args.splice( 0, 1, this );\n\t\t} else if ( typeof _args[ 0 ] !== \"object\" || ( typeof _args[ 0 ] === \"object\" && ( \"inputType\" in _args[ 0 ] ) ) ) {\n\t\t\t_args.unshift( this );\n\t\t}\n\t\treturn _args;\n\t},\n\n\tgetHandlerArgs( args, isCatchAll ) {\n\t\t// index 0 is the client, index 1 is inputType\n\t\t// if we're in a catch-all handler, input type needs to be included in the args\n\t\t// inputType might be an object, so we need to just get the inputType string if so\n\t\tconst _args = args;\n\t\tconst input = _args[ 1 ];\n\t\tif ( typeof inputType === \"object\" ) {\n\t\t\t_args.splice( 1, 1, input.inputType );\n\t\t}\n\t\treturn isCatchAll ?\n\t\t\t_args.slice( 1 ) :\n\t\t\t_args.slice( 2 );\n\t},\n\n\tgetSystemHandlerArgs( args /* client */ ) {\n\t\treturn args;\n\t},\n\n\t// \"classic\" machina FSM do not emit the client property on events (which would be the FSM itself)\n\tbuildEventPayload( ..._args ) {\n\t\tconst args = this.ensureClientArg( _args );\n\t\tconst data = args[ 1 ];\n\t\tif ( _.isPlainObject( data ) ) {\n\t\t\treturn _.extend( data, { namespace: this.namespace, } );\n\t\t}\n\t\treturn { data: data || null, namespace: this.namespace, };\n\t},\n};\n\n_.each( [\n\t\"handle\",\n\t\"transition\",\n\t\"deferUntilTransition\",\n\t\"processQueue\",\n\t\"clearQueue\",\n], function( methodWithClientInjected ) {\n\tFsm[ methodWithClientInjected ] = function( ..._args ) {\n\t\tconst args = this.ensureClientArg( _args );\n\t\treturn BehavioralFsm.prototype[ methodWithClientInjected ].apply( this, args );\n\t};\n} );\n\nFsm = BehavioralFsm.extend( Fsm );\n\nexport { Fsm };\n","import { instance as emitterInstance } from \"./emitter\";\nimport { Fsm } from \"./Fsm\";\nimport { BehavioralFsm } from \"./BehavioralFsm\";\nimport { utils } from \"./utils\";\n\nmodule.exports = {\n\t...emitterInstance,\n\tFsm,\n\tBehavioralFsm,\n\tutils,\n\teventListeners: {\n\t\tnewFsm: [],\n\t},\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__760__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(622);\n"],"sourceRoot":""}